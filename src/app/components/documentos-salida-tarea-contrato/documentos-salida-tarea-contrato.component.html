
<div class="container">
    <div class="row my-5 justify-content-md-end">
        <div class="col-10">
            <h2>DOCUMENTOS SALIDA - CONTRATO TAREA</h2>
        </div>

        <div class="col-2">
           <!-- <button type="button" class="btn btn-sml  btn-primary px-5" disabled>Buscar</button>-->
        </div>
    </div>

    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="asignadas-tab" data-bs-toggle="tab" data-bs-target="#asignadas" type="button" role="tab" aria-controls="asignadas" aria-selected="true">
                Lista
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">
                Documentos Salida
            </button>
        </li>

      </ul>
      <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="asignadas" role="tabpanel" aria-labelledby="asignadas-tab">
            <table class="table table-light table-striped border border-1">


                <thead class="bg-#F53621">
                    <tr>
                        <th scope="col"></th>
                        <th scope="col">
                            <input type="text" class="form-input" id="searchContrato" (keyup)="filterDSTareasContratos()" />
                        </th>
                        <th scope="col">
                            <input type="text" class="form-input" id="searchTarea"  (keyup)="filterDSTareasContratos()"/>
                        </th>
                        <th scope="col"></th>
                        <th scope="col"></th>
                        <th scope="col"></th>
                        <th scope="col-3"></th>
                    </tr>
                    <tr>
                        <th scope="col">N°</th>
                        <th scope="col">Contrato</th>
                        <th scope="col">Tarea</th>
                        <th scope="col">Documento Salida</th>
                        <th scope="col">Tipo Documento</th>
                        <th scope="col">Estado</th>
                        <th scope="col-3"></th>
                    </tr>
        
                </thead>
                <tbody>
                    <tr *ngFor="let tareaDS of listaTareaDocumentosSalida">
                        <ng-container *ngIf="tareaDS.documento_salida">
                            <td>#</td>
                            <td>{{tareaDS.contrato.contrato}}-{{tareaDS.contrato.contradoid}}</td>
                            <td>{{tareaDS.tarea.nombre_tarea}}</td>
                            <td>{{tareaDS.documento_salida.descripcion}}</td>
                            <td>{{tareaDS.documento_salida.tipo_documento}}</td>
                            <td>{{tareaDS.estado?'Activo':'Inactivo'}}</td>
                            
                            <td class="cell-btn">
                                <button type="button" class="btn btn-primary btn-sm" attr.data='{{tareaDS| json}}' (click)='editDocumentoSalidaTC($event)'>Editar</button>
                                <button type="button" class="btn btn-sm btn-danger" (click)='openModalDelete("documento-salida-tarea",tareaDS._id)'>Eliminar</button>
                            </td>
                        </ng-container>
                    </tr>
                </tbody>
            </table>
            <app-paginador #pagTDS (pagParams)="pagTareDocumentosSalida" (refreshLista)="refreshLista($event,'TareaDSalida')"></app-paginador>

            <div class="d-flex flex-row-reverse">
                <button type="button" class="btn btn-primary btn-sml px-5 " (click)="openModalDocumentoSalidaCT()">Nueva</button>
            </div>
        </div>
        <div class="tab-pane fade " id="home" role="tabpanel" aria-labelledby="home-tab">
            <table class="table table-light table-striped border border-1">


                <thead class="bg-#F53621">
                    <tr>
                        <th scope="col"></th>
                        <th scope="col">
                            <input type="text" class="form-input" id="searchDocumentoSalida" (keyup)="filterDE()"  />
                        </th>
                        <th scope="col"></th>
                        <th scope="col"></th>
                        <th scope="col"></th>
                    </tr>
                    <tr>
                        <th scope="col">N°</th>
                        <th scope="col">Documento Salida</th>
                        <th scope="col">Tipo Documento</th>
                        <th scope="col">Estado</th>
                        <th scope="col-3"></th>
                    </tr>
        
                </thead>
                <tbody>
                    <tr *ngFor="let documentoSalida of listaDocumentosSalida">
                        <td>#</td>
                        <td>{{documentoSalida.descripcion}}</td>
                        <td>{{documentoSalida.tipo_documento}}</td>
                        <td>{{documentoSalida.estado?'Activo':'Inactivo'}}</td>
                        <td class="cell-btn">
                            <button type="button" class="btn btn-primary btn-sm" attr.data='{{documentoSalida| json}}' (click)='editDocumentoSalida($event)'>Editar</button>
                            <button type="button" class="btn btn-sm btn-danger" (click)='openModalDelete("documento-salida",documentoSalida._id)'>Eliminar</button>
                        </td>
                    </tr>
                </tbody>
            </table>
            <app-paginador #pagDS (pagParams)="pagDocumentosSalida" (refreshLista)="refreshLista($event,'DSalida')"></app-paginador>

            <div class="d-flex flex-row-reverse">
                <button type="button" class="btn btn-primary btn-sml px-5 " (click)="openModalDocumentoSalida()">Nueva</button>
            </div>
        </div>
      </div>
</div>
<div [ngClass]="(showModalDocumentoSalidaTC) ? 'modal modalApp': 'modal '" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
            
          <h5 *ngIf="!showUpdateDocumentoSTC" class="modal-title">Registro Documento Salida - Contrato Tarea</h5>
          <h5 *ngIf="showUpdateDocumentoSTC" class="modal-title">Actualizar Documento Salida - Contrato Tarea</h5>
          <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>-->
        </div>
        <div class="modal-body">
            <div class="row">
                
                <div class="col-12 input-group mb-3" >
                    <label for="basic-url" class="form-label" style="margin-right: 10px;margin-top: 8px;">Contrato</label>
                    <input autocomplete="off" (keyup)="filterContratosFromTC()" (change)="getTareasContrato($event)" class="form-select" id="NcontratoC" list="listaContrato">
                    <datalist id="listaContrato"  >
                        <option *ngFor="let contrato of listaContrato" >{{contrato.contrato}}-{{contrato.contradoid}}</option>
                    </datalist>
                    <input type="hidden" class="form-select" id="contratoC" />
                </div>
                <div class="col-12 input-group mb-3" >
                    <label for="basic-url" class="form-label" style="margin-right: 10px;margin-top: 8px;">Tarea</label>
                    <select class="form-select" id="tareaC" >
                        <option value="">..seleccionar tarea</option>
                        <option value="{{tarea._id}}" *ngFor="let tarea of listaTareas">
                            {{tarea.nombre_tarea}}
                        </option>
                    </select>
                </div>
                <div class="col-12 input-group mb-3" >
                    <label for="basic-url" class="form-label" style="margin-right: 10px;margin-top: 8px;">Documento</label>
                    <select class="form-select" id="documentoSalidaC" >
                        <option value="">..seleccionar documento</option>
                        <option value="{{documentoSalida._id}}" *ngFor="let documentoSalida of listaDocumentosSalida">
                            {{documentoSalida.descripcion}}-{{documentoSalida.tipo_documento}}
                        </option>
                    </select>
                </div>
                <div [ngStyle]="{'display':showUpdateDocumentoSTC ? 'flex' : 'none' }"  class="col-12 input-group mb-3" >
                    <label for="basic-url" class="form-label" style="margin-right: 10px;margin-top: 8px;">Estado</label>
                    <select class="form-select" id="estadoDSTC" >
                        <option value="">..seleccionar estado</option>
                        <option value="1">Activo</option>
                        <option value="0">Inactivo</option>
                    </select>
                </div>
                <input type="hidden" class="form-control" id="id_documento_s_tc"  />
            </div>
        </div>
        <div class="modal-footer">
          <button *ngIf="showUpdateDocumentoSTC" type="button" class="btn btn-primary" (click)="updateDocumentoSalidaTC()">Actualizar</button>
          <button *ngIf="!showUpdateDocumentoSTC" type="button" class="btn btn-primary" (click)="addDocumentoSalidaTC()">Registrar</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="closeModalDocumentoSalidaCT()">Cerrar</button>
        </div>
      </div>
    </div>
</div>

<div [ngClass]="(showModalDocumentoSalida) ? 'modal modalApp': 'modal '" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 *ngIf="!showUpdateDocumentoS" class="modal-title">Registro Documento Salida</h5>
          <h5 *ngIf="showUpdateDocumentoS" class="modal-title">Actualizar Documento Salida</h5>
          <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>-->
        </div>
        <div class="modal-body">
            <div class="row">
                <div class="col-12 input-group mb-3" >
                    <label for="basic-url" class="form-label" style="margin-right: 10px;margin-top: 8px;"> Documento</label>
                    <input class="form-control" id="nombre_documento" placeholder="Escribir Nombre Documento" />
                </div>
                <div class="col-12 input-group mb-3" >
                    <label for="basic-url" class="form-label" style="margin-right: 10px;margin-top: 8px;">Tipo</label>
                    <select class="form-select" id="tipo_documento" >
                        <option value="">..seleccionar tipo</option>
                        <option value="word" >word</option>
                        <option value="excel" >excel</option>
                        <option value="pdf" >pdf</option>
                        <option value="pdf+doc" >pdf+doc</option>
                        <option value="zip" >zip</option>
                        <option value="url" >url</option>
                        <option value="txt" >txt</option>
                    </select>
                </div>
                <div class="col-12 input-group mb-3" style="display: none;">
                    <label for="basic-url" class="form-label" style="margin-right: 10px;margin-top: 8px;"> URL</label>
                    <input class="form-control" id="url_documento" placeholder="Escribir Url" />
                </div>
                <div [ngStyle]="{'display':showUpdateDocumentoS ? 'flex' : 'none' }"  class="col-12 input-group mb-3" >
                    <label for="basic-url" class="form-label" style="margin-right: 10px;margin-top: 8px;">Estado</label>
                    <select class="form-select" id="estadoDS" >
                        <option value="">..seleccionar estado</option>
                        <option value="1">Activo</option>
                        <option value="0">Inactivo</option>
                    </select>
                </div>
                <input type="hidden" class="form-control" id="id_documento_s"  />
            </div>
        </div>
        <div class="modal-footer">
          <button *ngIf="showUpdateDocumentoS" type="button" class="btn btn-primary" (click)="updateDocumentoSalida()">Actualizar</button>
          <button *ngIf="!showUpdateDocumentoS" type="button" class="btn btn-primary" (click)="addDocumentoSalida()">Registrar</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="closeModalDocumentoSalida()">Cerrar</button>
        </div>
      </div>
    </div>
</div>
<div [ngClass]="(showModalDelete) ? 'modal modalApp': 'modal '" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">{{ 'title.system_notification' | translate }}</h5>
          <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>-->
        </div>
        <div class="modal-body">
          <p> Estas seguro de eliminar este registro?</p>
          <input type="hidden" value="" id="idDelete" />
          <input type="hidden" value="" id="tipoDelete" />
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" (click)="actionDeleteModal()">{{ 'button.delete' | translate }}</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="closeModalDelete()">{{ 'button.close' | translate }}</button>
        </div>
      </div>
    </div>
</div>